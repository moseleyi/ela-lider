/*
 * ColorPicker
 * Copyright (c) 2011-2012 Martijn W. van der Lee
 * Licensed under the MIT.
 * Full-featured colorpicker for jQueryUI with full theming support.
 * Most images from jPicker by Christopher T. Tillman.
 * Sourcecode created from scratch by Martijn W. van der Lee.
 */
(function(b){b.colorpicker=new function(){this.regional=[];this.regional.en={ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"};this.regional.pl={ok:"OK",cancel:"Anuluj",none:"Brak",button:"Kolor",title:"Wybierz kolor",transparent:"Prze\u017aroczysto\u015b\u0107",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};var u=0,v={full:"header map bar hex hsv rgb alpha lab cmyk preview swatches footer".split(" "),popup:"map bar hex hsv rgb alpha preview footer".split(" "),draggable:"header map bar hex hsv rgb alpha preview footer".split(" "),inline:"map bar hex hsv rgb alpha preview".split(" ")},x=function(a){a=Math.round(a).toString(16);1===a.length&&(a="0"+a);return a.toLowerCase()},z={HEX:function(a){return s("#rxgxbx",a)},HEX3:function(a){var b=a.getRGB();a=Math.round(255*b.r);var d=Math.round(255*b.g),b=Math.round(255*b.b);return a>>>4==(a&=15)&&d>>>4==(d&=15)&&b>>>4==(b&=15)?"#"+a.toString(16)+d.toString(16)+b.toString(16):!1},RGBA:function(a){return s(1<=a.getAlpha()?"rgb(rd,gd,bd)":"rgba(rd,gd,bd,af)",a)},"RGBA%":function(a){return s(1<=a.getAlpha()?"rgb(rp%,gp%,bp%)":"rgba(rp%,gp%,bp%,af)",a)},HSLA:function(a){return s(1<=a.getAlpha()?"hsl(hd,sd,vd)":"hsla(hd,sd,vd,af)",a)},"HSLA%":function(a){return s(1<=a.getAlpha()?"hsl(hp%,sp%,vp%)":"hsla(hp%,sp%,vp%,af)",a)},NAME:function(a){return y(a)},EXACT:function(a){var c=!1;b.each(m,function(b,e){if(a.equals(new n(e.r,e.g,e.b)))return c=b,!1});return c}},s=function(a,c){var d=null,e={x:function(a){return x(255*a)},d:function(a){return Math.round(255*a)},f:function(a){return a},p:function(a){return 100*a}},f=c.getChannels();b.isArray(a)||(a=[a]);b.each(a,function(a,b){if(z[b])return d=z[b](c),!1===d;d=b.replace(/\\?[rgbhsva][xdfp]/g,function(a){return a.match(/^\\/)?a.slice(1):e[a[1]](f[a[0]])});return!1});return d},m={black:{r:0,g:0,b:0},dimgray:{r:0.4117647058823529,g:0.4117647058823529,b:0.4117647058823529},gray:{r:0.5019607843137255,g:0.5019607843137255,b:0.5019607843137255},darkgray:{r:0.6627450980392157,g:0.6627450980392157,b:0.6627450980392157},silver:{r:0.7529411764705882,g:0.7529411764705882,b:0.7529411764705882},lightgrey:{r:0.8274509803921568,g:0.8274509803921568,b:0.8274509803921568},gainsboro:{r:0.8627450980392157,g:0.8627450980392157,b:0.8627450980392157},whitesmoke:{r:0.9607843137254902,g:0.9607843137254902,b:0.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:0.7372549019607844,g:0.5607843137254902,b:0.5607843137254902},indianred:{r:0.803921568627451,g:0.3607843137254902,b:0.3607843137254902},brown:{r:0.6470588235294118,g:0.16470588235294117,b:0.16470588235294117},firebrick:{r:0.6980392156862745,g:0.13333333333333333,b:0.13333333333333333},lightcoral:{r:0.9411764705882353,g:0.5019607843137255,b:0.5019607843137255},maroon:{r:0.5019607843137255,g:0,b:0},darkred:{r:0.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:0.9803921568627451,b:0.9803921568627451},salmon:{r:0.9803921568627451,g:0.5019607843137255,b:0.4470588235294118},mistyrose:{r:1,g:0.8941176470588236,b:0.8823529411764706},tomato:{r:1,g:0.38823529411764707,b:0.2784313725490196},darksalmon:{r:0.9137254901960784,g:0.5882352941176471,b:0.47843137254901963},orangered:{r:1,g:0.27058823529411763,b:0},coral:{r:1,g:0.4980392156862745,b:0.3137254901960784},lightsalmon:{r:1,g:0.6274509803921569,b:0.47843137254901963},sienna:{r:0.6274509803921569,g:0.3215686274509804,b:0.17647058823529413},seashell:{r:1,g:0.9607843137254902,b:0.9333333333333333},chocolate:{r:0.8235294117647058,g:0.4117647058823529,b:0.11764705882352941},saddlebrown:{r:0.5450980392156862,g:0.27058823529411763,b:0.07450980392156863},sandybrown:{r:0.9568627450980393,g:0.6431372549019608,b:0.3764705882352941},peachpuff:{r:1,g:0.8549019607843137,b:0.7254901960784313},peru:{r:0.803921568627451,g:0.5215686274509804,b:0.24705882352941178},linen:{r:0.9803921568627451,g:0.9411764705882353,b:0.9019607843137255},darkorange:{r:1,g:0.5490196078431373,b:0},bisque:{r:1,g:0.8941176470588236,b:0.7686274509803922},burlywood:{r:0.8705882352941177,g:0.7215686274509804,b:0.5294117647058824},tan:{r:0.8235294117647058,g:0.7058823529411765,b:0.5490196078431373},antiquewhite:{r:0.9803921568627451,g:0.9215686274509803,b:0.8431372549019608},navajowhite:{r:1,g:0.8705882352941177,b:0.6784313725490196},blanchedalmond:{r:1,g:0.9215686274509803,b:0.803921568627451},papayawhip:{r:1,g:0.9372549019607843,b:0.8352941176470589},orange:{r:1,g:0.6470588235294118,b:0},moccasin:{r:1,g:0.8941176470588236,b:0.7098039215686275},wheat:{r:0.9607843137254902,g:0.8705882352941177,b:0.7019607843137254},oldlace:{r:0.9921568627450981,g:0.9607843137254902,b:0.9019607843137255},floralwhite:{r:1,g:0.9803921568627451,b:0.9411764705882353},goldenrod:{r:0.8549019607843137,g:0.6470588235294118,b:0.12549019607843137},darkgoldenrod:{r:0.7215686274509804,g:0.5254901960784314,b:0.043137254901960784},cornsilk:{r:1,g:0.9725490196078431,b:0.8627450980392157},gold:{r:1,g:0.8431372549019608,b:0},palegoldenrod:{r:0.9333333333333333,g:0.9098039215686274,b:0.6666666666666666},khaki:{r:0.9411764705882353,g:0.9019607843137255,b:0.5490196078431373},lemonchiffon:{r:1,g:0.9803921568627451,b:0.803921568627451},darkkhaki:{r:0.7411764705882353,g:0.7176470588235294,b:0.4196078431372549},beige:{r:0.9607843137254902,g:0.9607843137254902,b:0.8627450980392157},lightgoldenrodyellow:{r:0.9803921568627451,g:0.9803921568627451,b:0.8235294117647058},olive:{r:0.5019607843137255,g:0.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:0.8784313725490196},ivory:{r:1,g:1,b:0.9411764705882353},olivedrab:{r:0.4196078431372549,g:0.5568627450980392,b:0.13725490196078433},yellowgreen:{r:0.6039215686274509,g:0.803921568627451,b:0.19607843137254902},darkolivegreen:{r:0.3333333333333333,g:0.4196078431372549,b:0.1843137254901961},greenyellow:{r:0.6784313725490196,g:1,b:0.1843137254901961},lawngreen:{r:0.48627450980392156,g:0.9882352941176471,b:0},chartreuse:{r:0.4980392156862745,g:1,b:0},darkseagreen:{r:0.5607843137254902,g:0.7372549019607844,b:0.5607843137254902},forestgreen:{r:0.13333333333333333,g:0.5450980392156862,b:0.13333333333333333},limegreen:{r:0.19607843137254902,g:0.803921568627451,b:0.19607843137254902},lightgreen:{r:0.5647058823529412,g:0.9333333333333333,b:0.5647058823529412},palegreen:{r:0.596078431372549,g:0.984313725490196,b:0.596078431372549},darkgreen:{r:0,g:0.39215686274509803,b:0},green:{r:0,g:0.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:0.9411764705882353,g:1,b:0.9411764705882353},mediumseagreen:{r:0.23529411764705882,g:0.7019607843137254,b:0.44313725490196076},seagreen:{r:0.1803921568627451,g:0.5450980392156862,b:0.3411764705882353},springgreen:{r:0,g:1,b:0.4980392156862745},mintcream:{r:0.9607843137254902,g:1,b:0.9803921568627451},mediumspringgreen:{r:0,g:0.9803921568627451,b:0.6039215686274509},mediumaquamarine:{r:0.4,g:0.803921568627451,b:0.6666666666666666},aquamarine:{r:0.4980392156862745,g:1,b:0.8313725490196079},turquoise:{r:0.25098039215686274,g:0.8784313725490196,b:0.8156862745098039},lightseagreen:{r:0.12549019607843137,g:0.6980392156862745,b:0.6666666666666666},mediumturquoise:{r:0.2823529411764706,g:0.8196078431372549,b:0.8},darkslategray:{r:0.1843137254901961,g:0.30980392156862746,b:0.30980392156862746},paleturquoise:{r:0.6862745098039216,g:0.9333333333333333,b:0.9333333333333333},teal:{r:0,g:0.5019607843137255,b:0.5019607843137255},darkcyan:{r:0,g:0.5450980392156862,b:0.5450980392156862},darkturquoise:{r:0,g:0.807843137254902,b:0.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:0.8784313725490196,g:1,b:1},azure:{r:0.9411764705882353,g:1,b:1},cadetblue:{r:0.37254901960784315,g:0.6196078431372549,b:0.6274509803921569},powderblue:{r:0.6901960784313725,g:0.8784313725490196,b:0.9019607843137255},lightblue:{r:0.6784313725490196,g:0.8470588235294118,b:0.9019607843137255},deepskyblue:{r:0,g:0.7490196078431373,b:1},skyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9215686274509803},lightskyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9803921568627451},steelblue:{r:0.27450980392156865,g:0.5098039215686274,b:0.7058823529411765},aliceblue:{r:0.9411764705882353,g:0.9725490196078431,b:1},dodgerblue:{r:0.11764705882352941,g:0.5647058823529412,b:1},slategray:{r:0.4392156862745098,g:0.5019607843137255,b:0.5647058823529412},lightslategray:{r:0.4666666666666667,g:0.5333333333333333,b:0.6},lightsteelblue:{r:0.6901960784313725,g:0.7686274509803922,b:0.8705882352941177},cornflowerblue:{r:0.39215686274509803,g:0.5843137254901961,b:0.9294117647058824},royalblue:{r:0.2549019607843137,g:0.4117647058823529,b:0.8823529411764706},midnightblue:{r:0.09803921568627451,g:0.09803921568627451,b:0.4392156862745098},lavender:{r:0.9019607843137255,g:0.9019607843137255,b:0.9803921568627451},navy:{r:0,g:0,b:0.5019607843137255},darkblue:{r:0,g:0,b:0.5450980392156862},mediumblue:{r:0,g:0,b:0.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:0.9725490196078431,g:0.9725490196078431,b:1},darkslateblue:{r:0.2823529411764706,g:0.23921568627450981,b:0.5450980392156862},slateblue:{r:0.41568627450980394,g:0.35294117647058826,b:0.803921568627451},mediumslateblue:{r:0.4823529411764706,g:0.40784313725490196,b:0.9333333333333333},mediumpurple:{r:0.5764705882352941,g:0.4392156862745098,b:0.8588235294117647},blueviolet:{r:0.5411764705882353,g:0.16862745098039217,b:0.8862745098039215},indigo:{r:0.29411764705882354,g:0,b:0.5098039215686274},darkorchid:{r:0.6,g:0.19607843137254902,b:0.8},darkviolet:{r:0.5803921568627451,g:0,b:0.8274509803921568},mediumorchid:{r:0.7294117647058823,g:0.3333333333333333,b:0.8274509803921568},thistle:{r:0.8470588235294118,g:0.7490196078431373,b:0.8470588235294118},plum:{r:0.8666666666666667,g:0.6274509803921569,b:0.8666666666666667},violet:{r:0.9333333333333333,g:0.5098039215686274,b:0.9333333333333333},purple:{r:0.5019607843137255,g:0,b:0.5019607843137255},darkmagenta:{r:0.5450980392156862,g:0,b:0.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:0.8549019607843137,g:0.4392156862745098,b:0.8392156862745098},mediumvioletred:{r:0.7803921568627451,g:0.08235294117647059,b:0.5215686274509804},deeppink:{r:1,g:0.0784313725490196,b:0.5764705882352941},hotpink:{r:1,g:0.4117647058823529,b:0.7058823529411765},palevioletred:{r:0.8588235294117647,g:0.4392156862745098,b:0.5764705882352941},lavenderblush:{r:1,g:0.9411764705882353,b:0.9607843137254902},crimson:{r:0.8627450980392157,g:0.0784313725490196,b:0.23529411764705882},pink:{r:1,g:0.7529411764705882,b:0.796078431372549},lightpink:{r:1,g:0.7137254901960784,b:0.7568627450980392}},y=function(a){a.getRGB();var c=null,d=!1;b.each(m,function(b,f){var g=a.distance(new n(f.r,f.g,f.b));if(g<c||null===c){d=b;if(0==g)return!1;c=g}});return d},t=function(a){var c=b.trim(a).toLowerCase();return m[c]?new n(m[c].r,m[c].g,m[c].b):(a=/^#?([a-fA-F0-9]{1,6})/.exec(a))?(a=parseInt(a[1],16),new n((a>>16&255)/255,(a>>8&255)/255,(a&255)/255)):new n},A=function(a){var b;return""==a?new n:(b=/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/.exec(a))?new n(b[1]/255,b[2]/255,b[3]/255,parseFloat(b[4])):(b=/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/.exec(a))?new n(b[1]/100,b[2]/100,b[3]/100,b[4]/100):(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))?new n(parseInt(b[1],16)/255,parseInt(b[2],16)/255,parseInt(b[3],16)/255):(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))?new n(parseInt(b[1]+b[1],16)/255,parseInt(b[2]+b[2],16)/255,parseInt(b[3]+b[3],16)/255):t(a)},C=function(a,c){var d,e,f,g,h,w,p,k,j,l;a.sort(function(a,b){return a.pos[1]==b.pos[1]?a.pos[0]-b.pos[0]:a.pos[1]-b.pos[1]});h=g=0;b.each(a,function(a,b){g=Math.max(g,b.pos[0]+b.pos[2]);h=Math.max(h,b.pos[1]+b.pos[3])});d=[];for(e=0;e<g;++e)d.push(Array(h));p=Array(h);w=Array(g);b.each(a,function(a,b){for(e=0;e<b.pos[2];e+=1)w[b.pos[0]+e]=!0;for(f=0;f<b.pos[3];f+=1)p[b.pos[1]+f]=!0});l="";j=a[k=0];for(f=0;f<h;++f){l+="<tr>";for(e=0;e<g;)if(void 0!==j&&e==j.pos[0]&&f==j.pos[1]){var q,r;l+=c(j,e,f);for(r=0;r<j.pos[3];r+=1)for(q=0;q<j.pos[2];q+=1)d[e+q][f+r]=!0;e+=j.pos[2];j=a[++k]}else{q=0;for(r=!1;e<g&&void 0===d[e][f]&&(void 0===j||f<j.pos[1]||f==j.pos[1]&&e<j.pos[0]);)!0===w[e]&&(q+=1),r=!0,e+=1;0<q?l+='<td colspan="'+q+'"></td>':r||(e+=1)}l+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+l+"</tbody></table>"},B={header:function(a){var c=null,d;d=function(){var b='<span class="ui-dialog-title">'+(a.options.title?a.options.title:a._getRegional("title"))+"</span>";!a.inline&&a.options.showCloseButton&&(b+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>');return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+b+"</div>"};this.init=function(){c=b(d()).prependTo(a.dialog);var e=b(".ui-dialog-titlebar-close",c);a._hoverable(e);a._focusable(e);e.click(function(){a.close()});!a.inline&&a.options.draggable&&a.dialog.draggable({handle:c})}},map:function(a){var c=this,d=null,e,f,g,h;e=function(c){if(a.opened){var p=b(".ui-colorpicker-map-layer-pointer",d),k=p.offset(),h=p.width(),p=p.height(),l=c.pageX-k.left,k=c.pageY-k.top;0<=l&&(l<h&&0<=k&&k<p)&&(c.stopImmediatePropagation(),c.preventDefault(),b(document).unbind("mousedown",e),b(document).bind("mouseup",f),b(document).bind("mousemove",g),g(c))}};f=function(a){a.stopImmediatePropagation();a.preventDefault();b(document).unbind("mouseup",f);b(document).unbind("mousemove",g);b(document).bind("mousedown",e)};g=function(e){e.stopImmediatePropagation();e.preventDefault();if(!(e.pageX===c.x&&e.pageY===c.y)){c.x=e.pageX;c.y=e.pageY;var f=b(".ui-colorpicker-map-layer-pointer",d),g=f.offset(),h=f.width(),f=f.height(),l=e.pageX-g.left;e=e.pageY-g.top;l=Math.max(0,Math.min(l/h,1));e=Math.max(0,Math.min(e/f,1));switch(a.mode){case "h":a.color.setHSV(null,l,1-e);break;case "s":case "a":a.color.setHSV(l,null,1-e);break;case "v":a.color.setHSV(l,1-e,null);break;case "r":a.color.setRGB(null,1-e,l);break;case "g":a.color.setRGB(1-e,null,l);break;case "b":a.color.setRGB(l,1-e,null)}a._change()}};h=function(){return'<div class="ui-colorpicker-map" class="ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(a.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>'};this.generate=function(){switch(a.mode){case "h":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 0",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).hide();break;case "s":case "a":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 -260px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 -520px",opacity:""}).show();break;case "v":b(d).css("background-color","black");b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 -780px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).hide();break;case "r":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 -1040px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 -1300px",opacity:""}).show();break;case "g":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 -1560px",opacity:""}).show();b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 -1820px",opacity:""}).show();break;case "b":b(".ui-colorpicker-map-layer-1",d).css({"background-position":"0 -2080px",opacity:""}).show(),b(".ui-colorpicker-map-layer-2",d).css({"background-position":"0 -2340px",opacity:""}).show()}c.repaint()};this.repaint=function(){var e=b(".ui-colorpicker-map-layer-pointer",d),c=0,f=0;switch(a.mode){case "h":c=a.color.getHSV().s*e.width();f=(1-a.color.getHSV().v)*e.width();b(d).css("background-color",a.color.copy().normalize().toCSS());break;case "s":case "a":c=a.color.getHSV().h*e.width();f=(1-a.color.getHSV().v)*e.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",1-a.color.getHSV().s);break;case "v":c=a.color.getHSV().h*e.width();f=(1-a.color.getHSV().s)*e.width();b(".ui-colorpicker-map-layer-1",d).css("opacity",a.color.getHSV().v);break;case "r":c=a.color.getRGB().b*e.width();f=(1-a.color.getRGB().g)*e.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",a.color.getRGB().r);break;case "g":c=a.color.getRGB().b*e.width();f=(1-a.color.getRGB().r)*e.width();b(".ui-colorpicker-map-layer-2",d).css("opacity",a.color.getRGB().g);break;case "b":c=a.color.getRGB().r*e.width(),f=(1-a.color.getRGB().g)*e.width(),b(".ui-colorpicker-map-layer-2",d).css("opacity",a.color.getRGB().b)}a.options.alpha&&b(".ui-colorpicker-map-layer-alpha",d).css("opacity",1-a.color.getAlpha());b(".ui-colorpicker-map-pointer",d).css({left:c-7,top:f-7})};this.init=function(){d=b(h()).appendTo(b(".ui-colorpicker-map-container",a.dialog));d.bind("mousedown",e)}},bar:function(a){var c=this,d=null,e,f,g,h;e=function(c){if(a.opened){var h=b(".ui-colorpicker-bar-layer-pointer",d),k=h.offset(),j=h.width(),h=h.height(),l=c.pageX-k.left,k=c.pageY-k.top;0<=l&&(l<j&&0<=k&&k<h)&&(c.stopImmediatePropagation(),c.preventDefault(),b(document).unbind("mousedown",e),b(document).bind("mouseup",f),b(document).bind("mousemove",g),g(c))}};f=function(a){a.stopImmediatePropagation();a.preventDefault();b(document).unbind("mouseup",f);b(document).unbind("mousemove",g);b(document).bind("mousedown",e)};g=function(e){e.stopImmediatePropagation();e.preventDefault();if(e.pageY!==c.y){c.y=e.pageY;var f=b(".ui-colorpicker-bar-layer-pointer",d),g=f.offset(),f=f.height();e=e.pageY-g.top;e=Math.max(0,Math.min(e/f,1));switch(a.mode){case "h":a.color.setHSV(1-e,null,null);break;case "s":a.color.setHSV(null,1-e,null);break;case "v":a.color.setHSV(null,null,1-e);break;case "r":a.color.setRGB(1-e,null,null);break;case "g":a.color.setRGB(null,1-e,null);break;case "b":a.color.setRGB(null,null,1-e);break;case "a":a.color.setAlpha(1-e)}a._change()}};h=function(){var b='<div class="ui-colorpicker-bar" class="ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';a.options.alpha&&(b+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>');return b+'<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>'};this.generate=function(){switch(a.mode){case "h":case "s":case "v":case "r":case "g":case "b":b(".ui-colorpicker-bar-layer-alpha",d).show();b(".ui-colorpicker-bar-layer-alphabar",d).hide();break;case "a":b(".ui-colorpicker-bar-layer-alpha",d).hide(),b(".ui-colorpicker-bar-layer-alphabar",d).show()}switch(a.mode){case "h":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 0",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).hide();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "s":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 -260px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 -520px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "v":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 -520px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).hide();b(".ui-colorpicker-bar-layer-3",d).hide();b(".ui-colorpicker-bar-layer-4",d).hide();break;case "r":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 -1560px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 -1300px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 -780px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 -1040px",opacity:""}).show();break;case "g":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 -2600px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 -2340px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 -1820px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 -2080px",opacity:""}).show();break;case "b":b(".ui-colorpicker-bar-layer-1",d).css({"background-position":"0 -3640px",opacity:""}).show();b(".ui-colorpicker-bar-layer-2",d).css({"background-position":"0 -3380px",opacity:""}).show();b(".ui-colorpicker-bar-layer-3",d).css({"background-position":"0 -2860px",opacity:""}).show();b(".ui-colorpicker-bar-layer-4",d).css({"background-position":"0 -3120px",opacity:""}).show();break;case "a":b(".ui-colorpicker-bar-layer-1",d).hide(),b(".ui-colorpicker-bar-layer-2",d).hide(),b(".ui-colorpicker-bar-layer-3",d).hide(),b(".ui-colorpicker-bar-layer-4",d).hide()}c.repaint()};this.repaint=function(){var e=b(".ui-colorpicker-bar-layer-pointer",d),c=0;switch(a.mode){case "h":c=(1-a.color.getHSV().h)*e.height();break;case "s":c=(1-a.color.getHSV().s)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",1-a.color.getHSV().v);b(d).css("background-color",a.color.copy().normalize().toCSS());break;case "v":c=(1-a.color.getHSV().v)*e.height();b(d).css("background-color",a.color.copy().normalize().toCSS());break;case "r":c=(1-a.color.getRGB().r)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().b-a.color.getRGB().g));b(".ui-colorpicker-bar-layer-3",d).css("opacity",Math.max(0,a.color.getRGB().g-a.color.getRGB().b));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().b,a.color.getRGB().g));break;case "g":c=(1-a.color.getRGB().g)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().b-a.color.getRGB().r));b(".ui-colorpicker-bar-layer-3",d).css("opacity",Math.max(0,a.color.getRGB().r-a.color.getRGB().b));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().r,a.color.getRGB().b));break;case "b":c=(1-a.color.getRGB().b)*e.height();b(".ui-colorpicker-bar-layer-2",d).css("opacity",Math.max(0,a.color.getRGB().r-a.color.getRGB().g));b(".ui-colorpicker-bar-layer-3",d).css("opacity",Math.max(0,a.color.getRGB().g-a.color.getRGB().r));b(".ui-colorpicker-bar-layer-4",d).css("opacity",Math.min(a.color.getRGB().r,a.color.getRGB().g));break;case "a":c=(1-a.color.getAlpha())*e.height(),b(d).css("background-color",a.color.copy().normalize().toCSS())}"a"!==a.mode&&b(".ui-colorpicker-bar-layer-alpha",d).css("opacity",1-a.color.getAlpha());b(".ui-colorpicker-bar-pointer",d).css("top",c-3)};this.init=function(){d=b(h()).appendTo(b(".ui-colorpicker-bar-container",a.dialog));d.bind("mousedown",e)}},preview:function(a){var c=null,d;d=function(){return'<div class="ui-colorpicker-preview"><span class="ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></span></div>'};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-preview-container",a.dialog));b(".ui-colorpicker-preview-initial",c).click(function(){a.color=a.currentColor.copy();a._change()})};this.generate=function(){a.options.alpha?b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",c).show():b(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",c).hide();this.repaint()};this.repaint=function(){b(".ui-colorpicker-preview-initial",c).css("background-color",a.currentColor.toCSS()).attr("title",a.currentColor.toHex());b(".ui-colorpicker-preview-initial-alpha",c).css("opacity",1-a.currentColor.getAlpha());b(".ui-colorpicker-preview-current",c).css("background-color",a.color.toCSS()).attr("title",a.color.toHex());b(".ui-colorpicker-preview-current-alpha",c).css("opacity",1-a.color.getAlpha())}},hsv:function(a){var c=null,d;d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+a._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+a._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+a._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>');return'<div class="ui-colorpicker-hsv">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-hsv-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=b(this).val();a._generateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){a.color.setHSV(b(".ui-colorpicker-hsv-h .ui-colorpicker-number",c).val()/360,b(".ui-colorpicker-hsv-s .ui-colorpicker-number",c).val()/100,b(".ui-colorpicker-hsv-v .ui-colorpicker-number",c).val()/100);a._change()})};this.repaint=function(){var e=a.color.getHSV();e.h*=360;e.s*=100;e.v*=100;b.each(e,function(a,e){var d=b(".ui-colorpicker-hsv-"+a+" .ui-colorpicker-number",c);e=Math.round(e);d.val()!==e&&d.val(e)})};this.generate=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()}},rgb:function(a){var c=null,d;d=function(){var b="";a.options.rgb&&(b+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+a._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+a._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+a._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>');return'<div class="ui-colorpicker-rgb">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-rgb-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=b(this).val();a._generateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){a.color.setRGB(b(".ui-colorpicker-rgb-r .ui-colorpicker-number",c).val()/255,b(".ui-colorpicker-rgb-g .ui-colorpicker-number",c).val()/255,b(".ui-colorpicker-rgb-b .ui-colorpicker-number",c).val()/255);a._change()})};this.repaint=function(){b.each(a.color.getRGB(),function(a,d){var g=b(".ui-colorpicker-rgb-"+a+" .ui-colorpicker-number",c);d=Math.round(255*d);g.val()!==d&&g.val(d)})};this.generate=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()}},lab:function(a){var c=null,d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-lab-l"><label>'+a._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+a._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+a._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>');return'<div class="ui-colorpicker-lab">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-lab-container",a.dialog));b(".ui-colorpicker-number",c).on("change keyup",function(){a.color.setLAB(parseInt(b(".ui-colorpicker-lab-l .ui-colorpicker-number",c).val())/100,(parseInt(b(".ui-colorpicker-lab-a .ui-colorpicker-number",c).val())+128)/255,(parseInt(b(".ui-colorpicker-lab-b .ui-colorpicker-number",c).val())+128)/255);a._change()})};this.repaint=function(){var e=a.color.getLAB();e.l*=100;e.a=255*e.a-128;e.b=255*e.b-128;b.each(e,function(a,e){var d=b(".ui-colorpicker-lab-"+a+" .ui-colorpicker-number",c);e=Math.round(e);d.val()!==e&&d.val(e)})};this.generate=function(){this.repaint()}},cmyk:function(a){var c=null,d=function(){var b="";a.options.hsv&&(b+='<div class="ui-colorpicker-cmyk-c"><label>'+a._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+a._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+a._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+a._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>');return'<div class="ui-colorpicker-cmyk">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-cmyk-container",a.dialog));b(".ui-colorpicker-number",c).on("change keyup",function(){a.color.setCMYK(parseInt(b(".ui-colorpicker-cmyk-c .ui-colorpicker-number",c).val())/100,parseInt(b(".ui-colorpicker-cmyk-m .ui-colorpicker-number",c).val())/100,parseInt(b(".ui-colorpicker-cmyk-y .ui-colorpicker-number",c).val())/100,parseInt(b(".ui-colorpicker-cmyk-k .ui-colorpicker-number",c).val())/100);a._change()})};this.repaint=function(){b.each(a.color.getCMYK(),function(a,d){var g=b(".ui-colorpicker-cmyk-"+a+" .ui-colorpicker-number",c);d=Math.round(100*d);g.val()!==d&&g.val(d)})};this.generate=function(){this.repaint()}},alpha:function(a){var c=null,d;d=function(){var b="";a.options.alpha&&(b+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+a._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>');return'<div class="ui-colorpicker-alpha">'+b+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-alpha-container",a.dialog));b(".ui-colorpicker-mode",c).click(function(){a.mode=b(this).val();a._generateAllParts()});b(".ui-colorpicker-number",c).bind("change keyup",function(){a.color.setAlpha(b(".ui-colorpicker-a .ui-colorpicker-number",c).val()/100);a._change()})};this.generate=function(){b(".ui-colorpicker-mode",c).each(function(){b(this).attr("checked",b(this).val()===a.mode)});this.repaint()};this.repaint=function(){var e=b(".ui-colorpicker-a .ui-colorpicker-number",c),d=Math.round(100*a.color.getAlpha());!e.is(":focus")&&e.val()!==d&&e.val(d)}},hex:function(a){var c=null,d;d=function(){var b="";a.options.alpha&&(b+='<input class="ui-colorpicker-hex-alpha" maxlength="2" size="2"/>');return'<div class="ui-colorpicker-hex"><label>#</label>'+(b+'<input class="ui-colorpicker-hex-input" maxlength="6" size="6"/>')+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-hex-container",a.dialog));b(".ui-colorpicker-hex-input",c).bind("change keyup",function(){a.color=t(b(this).val());a._change()});b(".ui-colorpicker-hex-alpha",c).bind("change keyup",function(){a.color.setAlpha(parseInt(b(".ui-colorpicker-hex-alpha",c).val(),16)/255);a._change()})};this.generate=function(){this.repaint()};this.repaint=function(){b(".ui-colorpicker-hex-input",c).is(":focus")||b(".ui-colorpicker-hex-input",c).val(a.color.toHex(!0));b(".ui-colorpicker-hex-alpha",c).is(":focus")||b(".ui-colorpicker-hex-alpha",c).val(x(255*a.color.getAlpha()))}},swatches:function(a){var c=null,d=function(){var e="";b.each(a.options.swatches,function(a,b){var d=(new n(b.r,b.g,b.b)).toCSS();e+='<div class="ui-colorpicker-swatch" style="background-color: '+d+'" title="'+a+'"></div>'});return'<div class="ui-colorpicker-swatches" class="ui-colorpicker-border">'+e+"</div>"};this.init=function(){c=b(d()).appendTo(b(".ui-colorpicker-swatches-container",a.dialog));b(".ui-colorpicker-swatch",c).click(function(){a.color=A(b(this).css("background-color"));a._change()})}},footer:function(a){var c=null,d="ui-colorpicker-special-transparent-"+u,e="ui-colorpicker-special-none-"+u,f=function(){var b="";if(a.options.alpha||!a.inline&&a.options.showNoneButton)b+='<div class="ui-colorpicker-buttonset">',a.options.alpha&&(b+='<input type="radio" name="ui-colorpicker-special" id="'+d+'" class="ui-colorpicker-special-transparent"/><label for="'+d+'">'+a._getRegional("transparent")+"</label>"),!a.inline&&a.options.showNoneButton&&(b+='<input type="radio" name="ui-colorpicker-special" id="'+e+'" class="ui-colorpicker-special-none"><label for="'+e+'">'+a._getRegional("none")+"</label>"),b+="</div>";a.inline||(b+='<div class="ui-dialog-buttonset">',a.options.showCancelButton&&(b+='<button class="ui-colorpicker-cancel">'+a._getRegional("cancel")+"</button>"),b+='<button class="ui-colorpicker-ok">'+a._getRegional("ok")+"</button>",b+="</div>");return'<div class="ui-dialog-buttonpane ui-widget-content">'+b+"</div>"};this.init=function(){c=b(f()).appendTo(a.dialog);b(".ui-colorpicker-ok",c).button().click(function(){a.close()});b(".ui-colorpicker-cancel",c).button().click(function(){a.color=a.currentColor.copy();a._change(a.color.set);a.close()});b(".ui-colorpicker-buttonset",c).buttonset();b(".ui-colorpicker-special-color",c).click(function(){a._change()});b("#"+e,c).click(function(){a._change(!1)});b("#"+d,c).click(function(){a.color.setAlpha(0);a._change()})};this.repaint=function(){a.color.set?0==a.color.getAlpha()?b(".ui-colorpicker-special-transparent",c).attr("checked",!0).button("refresh"):b("input",c).attr("checked",!1).button("refresh"):b(".ui-colorpicker-special-none",c).attr("checked",!0).button("refresh");b(".ui-colorpicker-cancel",c).button(a.changed?"enable":"disable")};this.generate=function(){}}},n=function(){var a={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},c=1,d=arguments,e=function(a){if(isNaN(a)||null===a)return 0;"string"==typeof a&&(a=parseInt(a));return Math.max(0,Math.min(a,1))},f=function(a){var b=a%16;return"0123456789abcdef".charAt((a-b)/16)+"0123456789abcdef".charAt(b)},g=function(a){var b=0.04045<a.r?Math.pow((a.r+0.055)/1.055,2.4):a.r/12.92,e=0.04045<a.g?Math.pow((a.g+0.055)/1.055,2.4):a.g/12.92;a=0.04045<a.b?Math.pow((a.b+0.055)/1.055,2.4):a.b/12.92;return{x:0.4124*b+0.3576*e+0.1805*a,y:0.2126*b+0.7152*e+0.0722*a,z:0.0193*b+0.1192*e+0.9505*a}},h=function(a){var b=Math.min(a.r,a.g,a.b),e=Math.max(a.r,a.g,a.b),d=e-b,c,f={h:0,s:0,v:e};0===d?(f.h=0,f.s=0):(f.s=d/e,b=((e-a.r)/6+d/2)/d,c=((e-a.g)/6+d/2)/d,d=((e-a.b)/6+d/2)/d,a.r===e?f.h=d-c:a.g===e?f.h=1/3+b-d:a.b===e&&(f.h=2/3+c-b),0>f.h?f.h+=1:1<f.h&&(f.h-=1));return f},m=function(a){var b=Math.min(a.r,a.g,a.b),e=Math.max(a.r,a.g,a.b),d=e-b,c,f={h:0,s:0,l:(e+b)/2};0===d?(f.h=0,f.s=0):(f.s=0.5>f.l?d/(e+b):d/(2-e-b),b=((e-a.r)/6+d/2)/d,c=((e-a.g)/6+d/2)/d,d=((e-a.b)/6+d/2)/d,a.r===e?f.h=d-c:a.g===e?f.h=1/3+b-d:a.b===e&&(f.h=2/3+c-b),0>f.h?f.h+=1:1<f.h&&(f.h-=1));return f},p=function(a){var b=a.x/0.95047,e=a.y;a=a.z/1.08883;b=0.008856<b?Math.pow(b,1/3):7.787*b+16/116;e=0.008856<e?Math.pow(e,1/3):7.787*e+16/116;a=0.008856<a?Math.pow(a,1/3):7.787*a+16/116;return{l:(116*e-16)/100,a:(500*(b-e)+128)/255,b:(200*(e-a)+128)/255}},k=function(a){return{c:1-a.r,m:1-a.g,y:1-a.b}},j=function(a){var b=1;a.c<b&&(b=a.c);a.m<b&&(b=a.m);a.y<b&&(b=a.y);return 1==b?{c:0,m:0,y:0,k:1}:{c:(a.c-b)/(1-b),m:(a.m-b)/(1-b),y:(a.y-b)/(1-b),k:b}};this.set=!0;this.setAlpha=function(a){null!==a&&(c=e(a))};this.getAlpha=function(){return c};this.setRGB=function(b,d,c){a={rgb:this.getRGB()};null!==b&&(a.rgb.r=e(b));null!==d&&(a.rgb.g=e(d));null!==c&&(a.rgb.b=e(c))};this.setHSV=function(b,d,c){a={hsv:this.getHSV()};null!==b&&(a.hsv.h=e(b));null!==d&&(a.hsv.s=e(d));null!==c&&(a.hsv.v=e(c))};this.setHSL=function(b,d,c){a={hsl:this.getHSL()};null!==b&&(a.hsl.h=e(b));null!==d&&(a.hsl.s=e(d));null!==c&&(a.hsl.l=e(c))};this.setLAB=function(b,d,c){a={lab:this.getLAB()};null!==b&&(a.lab.l=e(b));null!==d&&(a.lab.a=e(d));null!==c&&(a.lab.b=e(c))};this.setCMYK=function(b,d,c,f){a={cmyk:this.getCMYK()};null!==b&&(a.cmyk.c=e(b));null!==d&&(a.cmyk.m=e(d));null!==c&&(a.cmyk.y=e(c));null!==f&&(a.cmyk.k=e(f))};this.getRGB=function(){if(!a.rgb){var d=a,c;if(a.lab){c=a.lab;var f=255*c.b-128,g=0,h=(100*c.l+16)/116,j=0,g=(255*c.a-128)/500+h,j=h-f/200,g=0.008856<Math.pow(g,3)?Math.pow(g,3):(g-16/116)/7.787,h=0.008856<Math.pow(h,3)?Math.pow(h,3):(h-16/116)/7.787,j=0.008856<Math.pow(j,3)?Math.pow(j,3):(j-16/116)/7.787,g=0.95047*g,h=1*h,j=1.08883*j;c={r:3.2406*g+-1.5372*h+-0.4986*j,g:-0.9689*g+1.8758*h+0.0415*j,b:0.0557*g+-0.204*h+1.057*j};c.r=0.0031308<c.r?1.055*Math.pow(c.r,1/2.4)-0.055:12.92*c.r;c.g=0.0031308<c.g?1.055*Math.pow(c.g,1/2.4)-0.055:12.92*c.g;c.b=0.0031308<c.b?1.055*Math.pow(c.b,1/2.4)-0.055:12.92*c.b}else if(a.hsv){c=a.hsv;f={r:0,g:0,b:0};if(0===c.s)f.r=f.g=f.b=c.v;else{var k=1===c.h?0:6*c.h,g=Math.floor(k),h=c.v*(1-c.s),j=c.v*(1-c.s*(k-g)),k=c.v*(1-c.s*(1-(k-g)));0===g?(f.r=c.v,f.g=k,f.b=h):1===g?(f.r=j,f.g=c.v,f.b=h):2===g?(f.r=h,f.g=c.v,f.b=k):3===g?(f.r=h,f.g=j,f.b=c.v):4===g?(f.r=k,f.g=h,f.b=c.v):(f.r=c.v,f.g=h,f.b=j)}c=f}else a.hsl?(c=a.hsl,f=function(a,b,c){0>c&&(c+=1);1<c&&(c-=1);return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a},0===c.s?c={r:c.l,g:c.l,b:c.l}:(g=0.5>c.l?c.l*(1+c.s):c.l+c.s-c.s*c.l,h=2*c.l-g,c={r:f(h,g,c.h+1/3),g:f(h,g,c.h),b:f(h,g,c.h-1/3)})):c=a.cmyk?{r:1-(a.cmyk.c*(1-a.cmyk.k)+a.cmyk.k),g:1-(a.cmyk.m*(1-a.cmyk.k)+a.cmyk.k),b:1-(a.cmyk.y*(1-a.cmyk.k)+a.cmyk.k)}:{r:0,g:0,b:0};d.rgb=c;a.rgb.r=e(a.rgb.r);a.rgb.g=e(a.rgb.g);a.rgb.b=e(a.rgb.b)}return b.extend({},a.rgb)};this.getHSV=function(){a.hsv||(a.hsv=a.lab?h(this.getRGB()):a.rgb?h(a.rgb):a.hsl?h(this.getRGB()):a.cmyk?h(this.getRGB()):{h:0,s:0,v:0},a.hsv.h=e(a.hsv.h),a.hsv.s=e(a.hsv.s),a.hsv.v=e(a.hsv.v));return b.extend({},a.hsv)};this.getHSL=function(){a.hsl||(a.hsl=a.rgb?m(a.rgb):a.hsv?m(this.getRGB()):a.cmyk?m(this.getRGB()):a.hsv?m(this.getRGB()):{h:0,s:0,l:0},a.hsl.h=e(a.hsl.h),a.hsl.s=e(a.hsl.s),a.hsl.l=e(a.hsl.l));return b.extend({},a.hsl)};this.getCMYK=function(){a.cmyk||(a.cmyk=a.rgb?j(k(a.rgb)):a.hsv?j(k(this.getRGB())):a.hsl?j(k(this.getRGB())):a.lab?j(k(this.getRGB())):{c:0,m:0,y:0,k:1},a.cmyk.c=e(a.cmyk.c),a.cmyk.m=e(a.cmyk.m),a.cmyk.y=e(a.cmyk.y),a.cmyk.k=e(a.cmyk.k));return b.extend({},a.cmyk)};this.getLAB=function(){a.lab||(a.lab=a.rgb?p(g(a.rgb)):a.hsv?p(g(this.getRGB())):a.hsl?p(g(this.getRGB())):a.cmyk?p(g(this.getRGB())):{l:0,a:0,b:0},a.lab.l=e(a.lab.l),a.lab.a=e(a.lab.a),a.lab.b=e(a.lab.b));return b.extend({},a.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v}};this.distance=function(a){var b=this.getLAB();a=a.getLAB();var c=0,d;for(d in b)c+=Math.pow(b[d]-a[d],2);return c};this.equals=function(a){var b=this.getRGB();a=a.getRGB();return b.r==a.r&&b.g==a.g&&b.b==a.b};this.limit=function(a){a-=1;var b=this.getRGB();this.setRGB(Math.round(b.r*a)/a,Math.round(b.g*a)/a,Math.round(b.b*a)/a)};this.toHex=function(){var a=this.getRGB();return f(255*a.r)+f(255*a.g)+f(255*a.b)};this.toCSS=function(){return"#"+this.toHex()};this.normalize=function(){this.setHSV(null,1,1);return this};this.copy=function(){var a=this.getRGB(),b=this.getAlpha();return new n(a.r,a.g,a.b,b)};0<d.length&&(this.setRGB(d[0],d[1],d[2]),this.setAlpha(0===d[3]?0:d[3]||1))};b.widget("vanderlee.colorpicker",{options:{alpha:!1,altAlpha:!0,altField:"",altOnChange:!0,altProperties:"background-color",autoOpen:!1,buttonColorize:!1,buttonImage:"/_scripts/images/ui-colorpicker.png",buttonImageOnly:!1,buttonText:null,closeOnEscape:!0,closeOnOutside:!0,color:"#00FF00",colorFormat:"HEX",draggable:!0,duration:"fast",hsv:!0,regional:"",layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:!1,mode:"h",parts:"",rgb:!0,showAnim:"fadeIn",showCancelButton:!0,showNoneButton:!1,showCloseButton:!0,showOn:"focus",showOptions:{},swatches:null,title:null,close:null,init:null,select:null},_create:function(){var a=this;++u;a.widgetEventPrefix="color";a.opened=!1;a.generated=!1;a.inline=!1;a.changed=!1;a.dialog=null;a.button=null;a.image=null;a.overlay=null;a.mode=a.options.mode;null===a.options.swatches&&(a.options.swatches=m);if("input"===this.element[0].nodeName.toLowerCase()){a._setColor(a.element.val());this._callback("init");b("body").append('<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>');a.dialog=b(".ui-colorpicker:last");b(document).mousedown(function(c){if(a.opened&&!(c.target===a.element[0]||a.overlay))if(0<b(c.target).closest(".ui-colorpicker").length)a.element.blur();else{var e;c=b(c.target).parents();for(e in c)if(null!==a.button&&c[e]===a.button[0])return;a.options.closeOnOutside&&a.close()}});b(document).keydown(function(b){27==b.keyCode&&(a.opened&&a.options.closeOnEscape)&&a.close()});("focus"===a.options.showOn||"both"===a.options.showOn)&&a.element.focus(function(){a.open()});if("button"===a.options.showOn||"both"===a.options.showOn){if(""!==a.options.buttonImage){var c=a.options.buttonText?a.options.buttonText:a._getRegional("button");a.image=b("<img/>").attr({src:a.options.buttonImage,alt:c,title:c});a._setImageBackground()}a.options.buttonImageOnly&&a.image?a.button=a.image:(a.button=b('<button type="button"></button>').html(a.image||a.options.buttonText).button(),a.image=a.image?b("img",a.button).first():null);a.button.insertAfter(a.element).click(function(){a[a.opened?"close":"open"]()})}a.options.autoOpen&&a.open();a.element.keydown(function(b){9===b.keyCode&&a.close()}).keyup(function(){var b=t(a.element.val());b&&(a.color=!1===b?new n:new n(b[0],b[1],b[2]),a._change())})}else a.inline=!0,b(this.element).html('<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>'),a.dialog=b(".ui-colorpicker",this.element),a._generate(),a.opened=!0;return this},destroy:function(){this.element.unbind();null!==this.image&&this.image.remove();null!==this.button&&this.button.remove();null!==this.dialog&&this.dialog.remove();this.overlay&&this.overlay.destroy()},_setOption:function(a,c){switch(a){case "disabled":c?this.dialog.addClass("ui-colorpicker-disabled"):this.dialog.removeClass("ui-colorpicker-disabled")}b.Widget.prototype._setOption.apply(this,arguments)},_setImageBackground:function(){this.image&&this.options.buttonColorize&&this.image.css("background-color",this.color.set?s("RGBA",this.color):"")},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var a,c,d=this.options.altProperties.split(",");for(a in d)switch(c=b.trim(d[a]),c){case "color":case "background-color":case "outline-color":case "border-color":b(this.options.altField).css(c,this.color.set?this.color.toCSS():"")}this.options.altAlpha&&b(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}},_setColor:function(a){this.color=A(a);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(a){this._setColor(a);this._change(this.color.set)},_generate:function(){var a=this,c;a._setColor(a.inline?a.options.color:a.element.val());c="string"===typeof a.options.parts?v[a.options.parts]?v[a.options.parts]:v[a.inline?"inline":"popup"]:a.options.parts;a.parts={};b.each(c,function(b,c){B[c]&&(a.parts[c]=new B[c](a))});if(!a.generated){var d=[];b.each(a.options.layout,function(b,c){a.parts[b]&&d.push({part:b,pos:c})});b(C(d,function(a,b,c){var d=["ui-colorpicker-"+a.part+"-container"];0<b&&d.push("ui-colorpicker-padding-left");0<c&&d.push("ui-colorpicker-padding-top");return'<td  class="'+d.join(" ")+'"'+(1<a.pos[2]?' colspan="'+a.pos[2]+'"':"")+(1<a.pos[3]?' rowspan="'+a.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(a.dialog).addClass("ui-dialog-content ui-widget-content");a._initAllParts();a._generateAllParts();a.generated=!0}},_effectGeneric:function(a,c,d,e,f){if(b.effects&&b.effects[this.options.showAnim])a[c](this.options.showAnim,this.options.showOptions,this.options.duration,f);else a["slideDown"===this.options.showAnim?d:"fadeIn"===this.options.showAnim?e:c](this.options.showAnim?this.options.duration:null,f),(!this.options.showAnim||!this.options.duration)&&f()},_effectShow:function(a,b){this._effectGeneric(a,"show","slideDown","fadeIn",b)},_effectHide:function(a,b){this._effectGeneric(a,"hide","slideUp","fadeOut",b)},open:function(){var a=this;if(!a.opened){a._generate();var c=a.element.offset(),d=c.left,c=c.top+a.element.outerHeight(),d=d-Math.max(0,d+a.dialog.width()-b(window).width()+20),c=c-Math.max(0,c+a.dialog.height()-b(window).height()+20);a.dialog.css({left:d,top:c});var e=0;b(a.element[0]).parents().each(function(){var a=b(this).css("z-index");if(("number"===typeof a||"string"===typeof a)&&""!==a&&!isNaN(a))return e=a,!1});a.dialog.css("z-index",e+=2);a.overlay=a.options.modal?new b.ui.dialog.overlay(a):null;a._effectShow(this.dialog);a.opened=!0;b(function(){a._repaintAllParts()})}},close:function(){var a=this;a.currentColor=a.color.copy();a.changed=!1;a._effectHide(a.dialog,function(){a.dialog.empty();a.generated=!1;a.opened=!1;a._callback("close",!0)});a.overlay&&a.overlay.destroy()},_callback:function(a,b){if(this.color.set){var d={formatted:s(this.options.colorFormat,this.color)},e=this.color.getLAB();e.a=2*e.a-1;e.b=2*e.b-1;!0===b&&(d.a=this.color.getAlpha(),d.rgb=this.color.getRGB(),d.hsv=this.color.getHSV(),d.cmyk=this.color.getCMYK(),d.hsl=this.color.getHSL(),d.lab=e);return this._trigger(a,null,d)}return this._trigger(a,null,{formatted:""})},_initAllParts:function(){b.each(this.parts,function(a,b){b.init&&b.init()})},_generateAllParts:function(){b.each(this.parts,function(a,b){b.generate&&b.generate()})},_repaintAllParts:function(){b.each(this.parts,function(a,b){b.repaint&&b.repaint()})},_change:function(a){this.color.set=!1!==a;this.changed=!0;switch(this.options.limit){case "websafe":this.color.limit(6);break;case "nibble":this.color.limit(16);break;case "binary":this.color.limit(2);break;case "name":a=y(this.color),this.color.setRGB(m[a].r,m[a].g,m[a].b)}this.inline||(this.color.set?this.color.equals(t(this.element.val()))||this.element.val(this.color.toHex()):this.element.val(""),this._setImageBackground(),this._setAltField());this.opened&&this._repaintAllParts();this._callback("select")},_hoverable:function(a){a.hover(function(){a.addClass("ui-state-hover")},function(){a.removeClass("ui-state-hover")})},_focusable:function(a){a.focus(function(){a.addClass("ui-state-focus")}).blur(function(){a.removeClass("ui-state-focus")})},_getRegional:function(a){return void 0!==b.colorpicker.regional[this.options.regional][a]?b.colorpicker.regional[this.options.regional][a]:b.colorpicker.regional[""][a]}})})(jQuery);